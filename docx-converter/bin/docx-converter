#!/usr/bin/env php
<?php

/**
 * DOCX Converter CLI Tool
 * 
 * Command-line interface for converting DOCX files to HTML/JSON
 * with style mapping support.
 */

// Autoload dependencies
$autoloadPaths = [
    __DIR__ . '/../../vendor/autoload.php',
    __DIR__ . '/../../../../vendor/autoload.php',
];

$autoloaderFound = false;
foreach ($autoloadPaths as $autoloadPath) {
    if (file_exists($autoloadPath)) {
        require_once $autoloadPath;
        $autoloaderFound = true;
        break;
    }
}

if (!$autoloaderFound) {
    fwrite(STDERR, "Error: Unable to find Composer autoloader.\n");
    fwrite(STDERR, "Please run 'composer install' first.\n");
    exit(1);
}

// Create Symfony Console Application
use Symfony\Component\Console\Application;
use DocxConverter\Console\ConvertCommand;
use DocxConverter\Console\BatchCommand;
use DocxConverter\Console\InspectCommand;

$application = new Application('DOCX Converter', '1.0.0');

// Register commands
$application->add(new ConvertCommand());
$application->add(new BatchCommand());
$application->add(new InspectCommand());

// Run the application
$application->run();
